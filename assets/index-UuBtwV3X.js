import{H as St,g as $t,d as Bt,e as J,f as K,n as tt}from"./index-Q9DXitEx.js";import{h as Tn,l as Cn}from"./index-Q9DXitEx.js";import{s as L,b as Ot,d as At,i as dt,T as et,a as nt,t as it}from"./transform-CqGPC-JM.js";import{o as wt}from"./ordinal-Cboi1Yqb.js";import{c as Ht}from"./colors-Cc3OSVma.js";import{s as It}from"./array-DEnAxiAM.js";import{w as Yt,c as mt}from"./path-CbwjOpE9.js";import{x as Nt,y as Lt}from"./point-DWREGWZc.js";import{m as gt,a as yt}from"./min-tv6RD-6E.js";import"./init-Gi6I4Gst.js";function Pt(t,e){let n,i=-1,o=-1;if(e===void 0)for(const a of t)++o,a!=null&&(n>a||n===void 0&&a>=a)&&(n=a,i=o);else for(let a of t)(a=e(a,++o,t))!=null&&(n>a||n===void 0&&a>=a)&&(n=a,i=o);return i}function Vt(t){let e;for(;e=t.sourceEvent;)t=e;return t}function P(t,e){if(t=Vt(t),e===void 0&&(e=t.currentTarget),e){var n=e.ownerSVGElement||e;if(n.createSVGPoint){var i=n.createSVGPoint();return i.x=t.clientX,i.y=t.clientY,i=i.matrixTransform(e.getScreenCTM().inverse()),[i.x,i.y]}if(e.getBoundingClientRect){var o=e.getBoundingClientRect();return[t.clientX-o.left-e.clientLeft,t.clientY-o.top-e.clientTop]}}return[t.pageX,t.pageY]}const lt={capture:!0,passive:!1};function ut(t){t.preventDefault(),t.stopImmediatePropagation()}function Ft(t){var e=t.document.documentElement,n=L(t).on("dragstart.drag",ut,lt);"onselectstart"in e?n.on("selectstart.drag",ut,lt):(e.__noselect=e.style.MozUserSelect,e.style.MozUserSelect="none")}function Gt(t,e){var n=t.document.documentElement,i=L(t).on("dragstart.drag",null);e&&(i.on("click.drag",ut,lt),setTimeout(function(){i.on("click.drag",null)},0)),"onselectstart"in n?i.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}var Kt=1e-12;function vt(t){return((t=Math.exp(t))+1/t)/2}function Wt(t){return((t=Math.exp(t))-1/t)/2}function Ut(t){return((t=Math.exp(2*t))-1)/(t+1)}const qt=function t(e,n,i){function o(a,l){var c=a[0],d=a[1],h=a[2],p=l[0],v=l[1],k=l[2],y=p-c,X=v-d,E=y*y+X*X,b,f;if(E<Kt)f=Math.log(k/h)/e,b=function(H){return[c+H*y,d+H*X,h*Math.exp(e*H*f)]};else{var C=Math.sqrt(E),_=(k*k-h*h+i*E)/(2*h*n*C),B=(k*k-h*h-i*E)/(2*k*n*C),$=Math.log(Math.sqrt(_*_+1)-_),D=Math.log(Math.sqrt(B*B+1)-B);f=(D-$)/e,b=function(H){var V=H*f,F=vt($),G=h/(n*C)*(F*Ut(e*V+$)-Wt($));return[c+G*y,d+G*X,h*F/vt(e*V+$)]}}return b.duration=f*1e3*e/Math.SQRT2,b}return o.rho=function(a){var l=Math.max(.001,+a),c=l*l,d=c*c;return t(l,c,d)},o}(Math.SQRT2,2,4),Zt=Ht("1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf");function Qt(t){return t.source}function Jt(t){return t.target}function te(t){let e=Qt,n=Jt,i=Nt,o=Lt,a=null,l=null,c=Yt(d);function d(){let h;const p=It.call(arguments),v=e.apply(this,p),k=n.apply(this,p);if(a==null&&(l=t(h=c())),l.lineStart(),p[0]=v,l.point(+i.apply(this,p),+o.apply(this,p)),p[0]=k,l.point(+i.apply(this,p),+o.apply(this,p)),l.lineEnd(),h)return l=null,h+""||null}return d.source=function(h){return arguments.length?(e=h,d):e},d.target=function(h){return arguments.length?(n=h,d):n},d.x=function(h){return arguments.length?(i=typeof h=="function"?h:mt(+h),d):i},d.y=function(h){return arguments.length?(o=typeof h=="function"?h:mt(+h),d):o},d.context=function(h){return arguments.length?(h==null?a=l=null:l=t(a=h),d):a},d}function ee(){return te(Ot)}const U=t=>()=>t;function ne(t,{sourceEvent:e,target:n,transform:i,dispatch:o}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:i,enumerable:!0,configurable:!0},_:{value:o}})}function rt(t){t.stopImmediatePropagation()}function W(t){t.preventDefault(),t.stopImmediatePropagation()}function ie(t){return(!t.ctrlKey||t.type==="wheel")&&!t.button}function re(){var t=this;return t instanceof SVGElement?(t=t.ownerSVGElement||t,t.hasAttribute("viewBox")?(t=t.viewBox.baseVal,[[t.x,t.y],[t.x+t.width,t.y+t.height]]):[[0,0],[t.width.baseVal.value,t.height.baseVal.value]]):[[0,0],[t.clientWidth,t.clientHeight]]}function xt(){return this.__zoom||dt}function oe(t){return-t.deltaY*(t.deltaMode===1?.05:t.deltaMode?1:.002)*(t.ctrlKey?10:1)}function ae(){return navigator.maxTouchPoints||"ontouchstart"in this}function se(t,e,n){var i=t.invertX(e[0][0])-n[0][0],o=t.invertX(e[1][0])-n[1][0],a=t.invertY(e[0][1])-n[0][1],l=t.invertY(e[1][1])-n[1][1];return t.translate(o>i?(i+o)/2:Math.min(0,i)||Math.max(0,o),l>a?(a+l)/2:Math.min(0,a)||Math.max(0,l))}function le(){var t=ie,e=re,n=se,i=oe,o=ae,a=[0,1/0],l=[[-1/0,-1/0],[1/0,1/0]],c=250,d=qt,h=At("start","zoom","end"),p,v,k,y=500,X=150,E=0,b=10;function f(r){r.property("__zoom",xt).on("wheel.zoom",V,{passive:!1}).on("mousedown.zoom",F).on("dblclick.zoom",G).filter(o).on("touchstart.zoom",s).on("touchmove.zoom",x).on("touchend.zoom touchcancel.zoom",R).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}f.transform=function(r,m,u,g){var z=r.selection?r.selection():r;z.property("__zoom",xt),r!==z?$(r,m,u,g):z.interrupt().each(function(){D(this,arguments).event(g).start().zoom(null,typeof m=="function"?m.apply(this,arguments):m).end()})},f.scaleBy=function(r,m,u,g){f.scaleTo(r,function(){var z=this.__zoom.k,S=typeof m=="function"?m.apply(this,arguments):m;return z*S},u,g)},f.scaleTo=function(r,m,u,g){f.transform(r,function(){var z=e.apply(this,arguments),S=this.__zoom,w=u==null?B(z):typeof u=="function"?u.apply(this,arguments):u,M=S.invert(w),T=typeof m=="function"?m.apply(this,arguments):m;return n(_(C(S,T),w,M),z,l)},u,g)},f.translateBy=function(r,m,u,g){f.transform(r,function(){return n(this.__zoom.translate(typeof m=="function"?m.apply(this,arguments):m,typeof u=="function"?u.apply(this,arguments):u),e.apply(this,arguments),l)},null,g)},f.translateTo=function(r,m,u,g,z){f.transform(r,function(){var S=e.apply(this,arguments),w=this.__zoom,M=g==null?B(S):typeof g=="function"?g.apply(this,arguments):g;return n(dt.translate(M[0],M[1]).scale(w.k).translate(typeof m=="function"?-m.apply(this,arguments):-m,typeof u=="function"?-u.apply(this,arguments):-u),S,l)},g,z)};function C(r,m){return m=Math.max(a[0],Math.min(a[1],m)),m===r.k?r:new et(m,r.x,r.y)}function _(r,m,u){var g=m[0]-u[0]*r.k,z=m[1]-u[1]*r.k;return g===r.x&&z===r.y?r:new et(r.k,g,z)}function B(r){return[(+r[0][0]+ +r[1][0])/2,(+r[0][1]+ +r[1][1])/2]}function $(r,m,u,g){r.on("start.zoom",function(){D(this,arguments).event(g).start()}).on("interrupt.zoom end.zoom",function(){D(this,arguments).event(g).end()}).tween("zoom",function(){var z=this,S=arguments,w=D(z,S).event(g),M=e.apply(z,S),T=u==null?B(M):typeof u=="function"?u.apply(z,S):u,I=Math.max(M[1][0]-M[0][0],M[1][1]-M[0][1]),j=z.__zoom,O=typeof m=="function"?m.apply(z,S):m,Y=d(j.invert(T).concat(I/j.k),O.invert(T).concat(I/O.k));return function(A){if(A===1)A=O;else{var N=Y(A),Q=I/N[2];A=new et(Q,T[0]-N[0]*Q,T[1]-N[1]*Q)}w.zoom(null,A)}})}function D(r,m,u){return!u&&r.__zooming||new H(r,m)}function H(r,m){this.that=r,this.args=m,this.active=0,this.sourceEvent=null,this.extent=e.apply(r,m),this.taps=0}H.prototype={event:function(r){return r&&(this.sourceEvent=r),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(r,m){return this.mouse&&r!=="mouse"&&(this.mouse[1]=m.invert(this.mouse[0])),this.touch0&&r!=="touch"&&(this.touch0[1]=m.invert(this.touch0[0])),this.touch1&&r!=="touch"&&(this.touch1[1]=m.invert(this.touch1[0])),this.that.__zoom=m,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(r){var m=L(this.that).datum();h.call(r,this.that,new ne(r,{sourceEvent:this.sourceEvent,target:f,type:r,transform:this.that.__zoom,dispatch:h}),m)}};function V(r,...m){if(!t.apply(this,arguments))return;var u=D(this,m).event(r),g=this.__zoom,z=Math.max(a[0],Math.min(a[1],g.k*Math.pow(2,i.apply(this,arguments)))),S=P(r);if(u.wheel)(u.mouse[0][0]!==S[0]||u.mouse[0][1]!==S[1])&&(u.mouse[1]=g.invert(u.mouse[0]=S)),clearTimeout(u.wheel);else{if(g.k===z)return;u.mouse=[S,g.invert(S)],nt(this),u.start()}W(r),u.wheel=setTimeout(w,X),u.zoom("mouse",n(_(C(g,z),u.mouse[0],u.mouse[1]),u.extent,l));function w(){u.wheel=null,u.end()}}function F(r,...m){if(k||!t.apply(this,arguments))return;var u=r.currentTarget,g=D(this,m,!0).event(r),z=L(r.view).on("mousemove.zoom",T,!0).on("mouseup.zoom",I,!0),S=P(r,u),w=r.clientX,M=r.clientY;Ft(r.view),rt(r),g.mouse=[S,this.__zoom.invert(S)],nt(this),g.start();function T(j){if(W(j),!g.moved){var O=j.clientX-w,Y=j.clientY-M;g.moved=O*O+Y*Y>E}g.event(j).zoom("mouse",n(_(g.that.__zoom,g.mouse[0]=P(j,u),g.mouse[1]),g.extent,l))}function I(j){z.on("mousemove.zoom mouseup.zoom",null),Gt(j.view,g.moved),W(j),g.event(j).end()}}function G(r,...m){if(t.apply(this,arguments)){var u=this.__zoom,g=P(r.changedTouches?r.changedTouches[0]:r,this),z=u.invert(g),S=u.k*(r.shiftKey?.5:2),w=n(_(C(u,S),g,z),e.apply(this,m),l);W(r),c>0?L(this).transition().duration(c).call($,w,g,r):L(this).call(f.transform,w,g,r)}}function s(r,...m){if(t.apply(this,arguments)){var u=r.touches,g=u.length,z=D(this,m,r.changedTouches.length===g).event(r),S,w,M,T;for(rt(r),w=0;w<g;++w)M=u[w],T=P(M,this),T=[T,this.__zoom.invert(T),M.identifier],z.touch0?!z.touch1&&z.touch0[2]!==T[2]&&(z.touch1=T,z.taps=0):(z.touch0=T,S=!0,z.taps=1+!!p);p&&(p=clearTimeout(p)),S&&(z.taps<2&&(v=T[0],p=setTimeout(function(){p=null},y)),nt(this),z.start())}}function x(r,...m){if(this.__zooming){var u=D(this,m).event(r),g=r.changedTouches,z=g.length,S,w,M,T;for(W(r),S=0;S<z;++S)w=g[S],M=P(w,this),u.touch0&&u.touch0[2]===w.identifier?u.touch0[0]=M:u.touch1&&u.touch1[2]===w.identifier&&(u.touch1[0]=M);if(w=u.that.__zoom,u.touch1){var I=u.touch0[0],j=u.touch0[1],O=u.touch1[0],Y=u.touch1[1],A=(A=O[0]-I[0])*A+(A=O[1]-I[1])*A,N=(N=Y[0]-j[0])*N+(N=Y[1]-j[1])*N;w=C(w,Math.sqrt(A/N)),M=[(I[0]+O[0])/2,(I[1]+O[1])/2],T=[(j[0]+Y[0])/2,(j[1]+Y[1])/2]}else if(u.touch0)M=u.touch0[0],T=u.touch0[1];else return;u.zoom("touch",n(_(w,M,T),u.extent,l))}}function R(r,...m){if(this.__zooming){var u=D(this,m).event(r),g=r.changedTouches,z=g.length,S,w;for(rt(r),k&&clearTimeout(k),k=setTimeout(function(){k=null},y),S=0;S<z;++S)w=g[S],u.touch0&&u.touch0[2]===w.identifier?delete u.touch0:u.touch1&&u.touch1[2]===w.identifier&&delete u.touch1;if(u.touch1&&!u.touch0&&(u.touch0=u.touch1,delete u.touch1),u.touch0)u.touch0[1]=this.__zoom.invert(u.touch0[0]);else if(u.end(),u.taps===2&&(w=P(w,this),Math.hypot(v[0]-w[0],v[1]-w[1])<b)){var M=L(this).on("dblclick.zoom");M&&M.apply(this,arguments)}}}return f.wheelDelta=function(r){return arguments.length?(i=typeof r=="function"?r:U(+r),f):i},f.filter=function(r){return arguments.length?(t=typeof r=="function"?r:U(!!r),f):t},f.touchable=function(r){return arguments.length?(o=typeof r=="function"?r:U(!!r),f):o},f.extent=function(r){return arguments.length?(e=typeof r=="function"?r:U([[+r[0][0],+r[0][1]],[+r[1][0],+r[1][1]]]),f):e},f.scaleExtent=function(r){return arguments.length?(a[0]=+r[0],a[1]=+r[1],f):[a[0],a[1]]},f.translateExtent=function(r){return arguments.length?(l[0][0]=+r[0][0],l[1][0]=+r[1][0],l[0][1]=+r[0][1],l[1][1]=+r[1][1],f):[[l[0][0],l[0][1]],[l[1][0],l[1][1]]]},f.constrain=function(r){return arguments.length?(n=r,f):n},f.duration=function(r){return arguments.length?(c=+r,f):c},f.interpolate=function(r){return arguments.length?(d=r,f):d},f.on=function(){var r=h.on.apply(h,arguments);return r===h?f:r},f.clickDistance=function(r){return arguments.length?(E=(r=+r)*r,f):Math.sqrt(E)},f.tapDistance=function(r){return arguments.length?(b=+r,f):b},f}/*! @gera2ld/jsx-dom v2.2.2 | ISC License */const Et=1,Mt=2,ue="http://www.w3.org/2000/svg",ot="http://www.w3.org/1999/xlink",ce={show:ot,actuate:ot,href:ot},he=t=>typeof t=="string"||typeof t=="number",de=t=>(t==null?void 0:t.vtype)===Et,fe=t=>(t==null?void 0:t.vtype)===Mt;function q(t,e){let n;if(typeof t=="string")n=Et;else if(typeof t=="function")n=Mt;else throw new Error("Invalid VNode type");return{vtype:n,type:t,props:e}}function pe(t){return t.children}const me={isSvg:!1};function zt(t,e){Array.isArray(e)||(e=[e]),e=e.filter(Boolean),e.length&&t.append(...e)}function ge(t,e,n){for(const i in e)if(!(i==="key"||i==="children"||i==="ref"))if(i==="dangerouslySetInnerHTML")t.innerHTML=e[i].__html;else if(i==="innerHTML"||i==="textContent"||i==="innerText"||i==="value"&&["textarea","select"].includes(t.tagName)){const o=e[i];o!=null&&(t[i]=o)}else i.startsWith("on")?t[i.toLowerCase()]=e[i]:ve(t,i,e[i],n.isSvg)}const ye={className:"class",labelFor:"for"};function ve(t,e,n,i){if(e=ye[e]||e,n===!0)t.setAttribute(e,"");else if(n===!1)t.removeAttribute(e);else{const o=i?ce[e]:void 0;o!==void 0?t.setAttributeNS(o,e,n):t.setAttribute(e,n)}}function xe(t){return t.reduce((e,n)=>e.concat(n),[])}function ct(t,e){return Array.isArray(t)?xe(t.map(n=>ct(n,e))):ft(t,e)}function ft(t,e=me){if(t==null||typeof t=="boolean")return null;if(t instanceof Node)return t;if(fe(t)){const{type:n,props:i}=t;if(n===pe){const a=document.createDocumentFragment();if(i.children){const l=ct(i.children,e);zt(a,l)}return a}const o=n(i);return ft(o,e)}if(he(t))return document.createTextNode(`${t}`);if(de(t)){let n;const{type:i,props:o}=t;if(!e.isSvg&&i==="svg"&&(e=Object.assign({},e,{isSvg:!0})),e.isSvg?n=document.createElementNS(ue,i):n=document.createElement(i),ge(n,o,e),o.children){let l=e;e.isSvg&&i==="foreignObject"&&(l=Object.assign({},l,{isSvg:!1}));const c=ct(o.children,l);c!=null&&zt(n,c)}const{ref:a}=o;return typeof a=="function"&&a(n),n}throw new Error("mount: Invalid Vnode!")}function at(t){return ft(t)}function ze(t){var e=0,n=t.children,i=n&&n.length;if(!i)e=1;else for(;--i>=0;)e+=n[i].value;t.value=e}function be(){return this.eachAfter(ze)}function ke(t){var e=this,n,i=[e],o,a,l;do for(n=i.reverse(),i=[];e=n.pop();)if(t(e),o=e.children,o)for(a=0,l=o.length;a<l;++a)i.push(o[a]);while(i.length);return this}function Se(t){for(var e=this,n=[e],i,o;e=n.pop();)if(t(e),i=e.children,i)for(o=i.length-1;o>=0;--o)n.push(i[o]);return this}function we(t){for(var e=this,n=[e],i=[],o,a,l;e=n.pop();)if(i.push(e),o=e.children,o)for(a=0,l=o.length;a<l;++a)n.push(o[a]);for(;e=i.pop();)t(e);return this}function Ee(t){return this.eachAfter(function(e){for(var n=+t(e.data)||0,i=e.children,o=i&&i.length;--o>=0;)n+=i[o].value;e.value=n})}function Me(t){return this.eachBefore(function(e){e.children&&e.children.sort(t)})}function Xe(t){for(var e=this,n=Te(e,t),i=[e];e!==n;)e=e.parent,i.push(e);for(var o=i.length;t!==n;)i.splice(o,0,t),t=t.parent;return i}function Te(t,e){if(t===e)return t;var n=t.ancestors(),i=e.ancestors(),o=null;for(t=n.pop(),e=i.pop();t===e;)o=t,t=n.pop(),e=i.pop();return o}function Ce(){for(var t=this,e=[t];t=t.parent;)e.push(t);return e}function je(){var t=[];return this.each(function(e){t.push(e)}),t}function _e(){var t=[];return this.eachBefore(function(e){e.children||t.push(e)}),t}function De(){var t=this,e=[];return t.each(function(n){n!==t&&e.push({source:n.parent,target:n})}),e}function pt(t,e){var n=new Z(t),i=+t.value&&(n.value=t.value),o,a=[n],l,c,d,h;for(e==null&&(e=$e);o=a.pop();)if(i&&(o.value=+o.data.value),(c=e(o.data))&&(h=c.length))for(o.children=new Array(h),d=h-1;d>=0;--d)a.push(l=o.children[d]=new Z(c[d])),l.parent=o,l.depth=o.depth+1;return n.eachBefore(Oe)}function Re(){return pt(this).eachBefore(Be)}function $e(t){return t.children}function Be(t){t.data=t.data.data}function Oe(t){var e=0;do t.height=e;while((t=t.parent)&&t.height<++e)}function Z(t){this.data=t,this.depth=this.height=0,this.parent=null}Z.prototype=pt.prototype={constructor:Z,count:be,each:ke,eachAfter:we,eachBefore:Se,sum:Ee,sort:Me,path:Xe,ancestors:Ce,descendants:je,leaves:_e,links:De,copy:Re};const Ae="d3-flextree",He="2.1.2",Ie="build/d3-flextree.js",Ye="index",Ne={name:"Chris Maloney",url:"http://chrismaloney.org"},Le="Flexible tree layout algorithm that allows for variable node sizes.",Pe=["d3","d3-module","layout","tree","hierarchy","d3-hierarchy","plugin","d3-plugin","infovis","visualization","2d"],Ve="https://github.com/klortho/d3-flextree",Fe="WTFPL",Ge={type:"git",url:"https://github.com/klortho/d3-flextree.git"},Ke={clean:"rm -rf build demo test","build:demo":"rollup -c --environment BUILD:demo","build:dev":"rollup -c --environment BUILD:dev","build:prod":"rollup -c --environment BUILD:prod","build:test":"rollup -c --environment BUILD:test",build:"rollup -c",lint:"eslint index.js src","test:main":"node test/bundle.js","test:browser":"node test/browser-tests.js",test:"npm-run-all test:*",prepare:"npm-run-all clean build lint test"},We={"d3-hierarchy":"^1.1.5"},Ue={"babel-plugin-external-helpers":"^6.22.0","babel-preset-es2015-rollup":"^3.0.0",d3:"^4.13.0","d3-selection-multi":"^1.0.1",eslint:"^4.19.1",jsdom:"^11.6.2","npm-run-all":"^4.1.2",rollup:"^0.55.3","rollup-plugin-babel":"^2.7.1","rollup-plugin-commonjs":"^8.0.2","rollup-plugin-copy":"^0.2.3","rollup-plugin-json":"^2.3.0","rollup-plugin-node-resolve":"^3.0.2","rollup-plugin-uglify":"^3.0.0","uglify-es":"^3.3.9"},qe={name:Ae,version:He,main:Ie,module:Ye,"jsnext:main":"index",author:Ne,description:Le,keywords:Pe,homepage:Ve,license:Fe,repository:Ge,scripts:Ke,dependencies:We,devDependencies:Ue},{version:Ze}=qe,Qe=Object.freeze({children:t=>t.children,nodeSize:t=>t.data.size,spacing:0});function Tt(t){const e=Object.assign({},Qe,t);function n(c){const d=e[c];return typeof d=="function"?d:()=>d}function i(c){const d=l(a(),c,h=>h.children);return d.update(),d.data}function o(){const c=n("nodeSize"),d=n("spacing");return class Xt extends pt.prototype.constructor{constructor(p){super(p)}copy(){const p=l(this.constructor,this,v=>v.children);return p.each(v=>v.data=v.data.data),p}get size(){return c(this)}spacing(p){return d(this,p)}get nodes(){return this.descendants()}get xSize(){return this.size[0]}get ySize(){return this.size[1]}get top(){return this.y}get bottom(){return this.y+this.ySize}get left(){return this.x-this.xSize/2}get right(){return this.x+this.xSize/2}get root(){const p=this.ancestors();return p[p.length-1]}get numChildren(){return this.hasChildren?this.children.length:0}get hasChildren(){return!this.noChildren}get noChildren(){return this.children===null}get firstChild(){return this.hasChildren?this.children[0]:null}get lastChild(){return this.hasChildren?this.children[this.numChildren-1]:null}get extents(){return(this.children||[]).reduce((p,v)=>Xt.maxExtents(p,v.extents),this.nodeExtents)}get nodeExtents(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}static maxExtents(p,v){return{top:Math.min(p.top,v.top),bottom:Math.max(p.bottom,v.bottom),left:Math.min(p.left,v.left),right:Math.max(p.right,v.right)}}}}function a(){const c=o(),d=n("nodeSize"),h=n("spacing");return class extends c{constructor(p){super(p),Object.assign(this,{x:0,y:0,relX:0,prelim:0,shift:0,change:0,lExt:this,lExtRelX:0,lThr:null,rExt:this,rExtRelX:0,rThr:null})}get size(){return d(this.data)}spacing(p){return h(this.data,p.data)}get x(){return this.data.x}set x(p){this.data.x=p}get y(){return this.data.y}set y(p){this.data.y=p}update(){return Ct(this),jt(this),this}}}function l(c,d,h){const p=(v,k)=>{const y=new c(v);Object.assign(y,{parent:k,depth:k===null?0:k.depth+1,height:0,length:1});const X=h(v)||[];return y.children=X.length===0?null:X.map(E=>p(E,y)),y.children&&Object.assign(y,y.children.reduce((E,b)=>({height:Math.max(E.height,b.height+1),length:E.length+b.length}),y)),y};return p(d,null)}return Object.assign(i,{nodeSize(c){return arguments.length?(e.nodeSize=c,i):e.nodeSize},spacing(c){return arguments.length?(e.spacing=c,i):e.spacing},children(c){return arguments.length?(e.children=c,i):e.children},hierarchy(c,d){const h=typeof d>"u"?e.children:d;return l(o(),c,h)},dump(c){const d=n("nodeSize"),h=p=>v=>{const k=p+"  ",y=p+"    ",{x:X,y:E}=v,b=d(v),f=v.children||[],C=f.length===0?" ":`,${k}children: [${y}${f.map(h(y)).join(y)}${k}],${p}`;return`{ size: [${b.join(", ")}],${k}x: ${X}, y: ${E}${C}},`};return h(`
`)(c)}}),i}Tt.version=Ze;const Ct=(t,e=0)=>(t.y=e,(t.children||[]).reduce((n,i)=>{const[o,a]=n;Ct(i,t.y+t.ySize);const l=(o===0?i.lExt:i.rExt).bottom;o!==0&&tn(t,o,a);const c=un(l,o,a);return[o+1,c]},[0,null]),Je(t),ln(t),t),jt=(t,e,n)=>{typeof e>"u"&&(e=-t.relX-t.prelim,n=0);const i=e+t.relX;return t.relX=i+t.prelim-n,t.prelim=0,t.x=n+t.relX,(t.children||[]).forEach(o=>jt(o,i,t.x)),t},Je=t=>{(t.children||[]).reduce((e,n)=>{const[i,o]=e,a=i+n.shift,l=o+a+n.change;return n.relX+=l,[a,l]},[0,0])},tn=(t,e,n)=>{const i=t.children[e-1],o=t.children[e];let a=i,l=i.relX,c=o,d=o.relX,h=!0;for(;a&&c;){a.bottom>n.lowY&&(n=n.next);const p=l+a.prelim-(d+c.prelim)+a.xSize/2+c.xSize/2+a.spacing(c);(p>0||p<0&&h)&&(d+=p,en(o,p),nn(t,e,n.index,p)),h=!1;const v=a.bottom,k=c.bottom;v<=k&&(a=on(a),a&&(l+=a.relX)),v>=k&&(c=rn(c),c&&(d+=c.relX))}!a&&c?an(t,e,c,d):a&&!c&&sn(t,e,a,l)},en=(t,e)=>{t.relX+=e,t.lExtRelX+=e,t.rExtRelX+=e},nn=(t,e,n,i)=>{const o=t.children[e],a=e-n;if(a>1){const l=i/a;t.children[n+1].shift+=l,o.shift-=l,o.change-=i-l}},rn=t=>t.hasChildren?t.firstChild:t.lThr,on=t=>t.hasChildren?t.lastChild:t.rThr,an=(t,e,n,i)=>{const o=t.firstChild,a=o.lExt,l=t.children[e];a.lThr=n;const c=i-n.relX-o.lExtRelX;a.relX+=c,a.prelim-=c,o.lExt=l.lExt,o.lExtRelX=l.lExtRelX},sn=(t,e,n,i)=>{const o=t.children[e],a=o.rExt,l=t.children[e-1];a.rThr=n;const c=i-n.relX-o.rExtRelX;a.relX+=c,a.prelim-=c,o.rExt=l.rExt,o.rExtRelX=l.rExtRelX},ln=t=>{if(t.hasChildren){const e=t.firstChild,n=t.lastChild,i=(e.prelim+e.relX-e.xSize/2+n.relX+n.prelim+n.xSize/2)/2;Object.assign(t,{prelim:i,lExt:e.lExt,lExtRelX:e.lExtRelX,rExt:n.rExt,rExtRelX:n.rExtRelX})}},un=(t,e,n)=>{for(;n!==null&&t>=n.lowY;)n=n.next;return{lowY:t,index:e,next:n}},_t=".markmap{font:300 16px/20px sans-serif}.markmap-link{fill:none}.markmap-node>circle{cursor:pointer}.markmap-foreign{display:inline-block}.markmap-foreign a{color:#0097e6}.markmap-foreign a:hover{color:#00a8ff}.markmap-foreign code{padding:.25em;font-size:calc(1em - 2px);color:#555;background-color:#f0f0f0;border-radius:2px}.markmap-foreign pre{margin:0}.markmap-foreign pre>code{display:block}.markmap-foreign del{text-decoration:line-through}.markmap-foreign em{font-style:italic}.markmap-foreign strong{font-weight:700}.markmap-foreign mark{background:#ffeaa7}",cn=".markmap-container{position:absolute;width:0;height:0;top:-100px;left:-100px;overflow:hidden}.markmap-container>.markmap-foreign{display:inline-block}.markmap-container>.markmap-foreign>div:last-child,.markmap-container>.markmap-foreign>div:last-child :not(pre){white-space:nowrap}.markmap-container>.markmap-foreign>div:last-child code{white-space:inherit}",wn=_t;function bt(t){const e=t.data;return Math.max(4-2*e.depth,1.5)}function kt(t,e){const n=Pt(t,e);return t[n]}function st(t){t.stopPropagation()}function hn(){return{transformHtml:new St}}const dn=new St,fn=wt(Zt),Dt=typeof navigator<"u"&&navigator.userAgent.includes("Macintosh"),Rt=class ht{constructor(e,n){this.options=ht.defaultOptions,this.revokers=[],this.handleZoom=i=>{const{transform:o}=i;this.g.attr("transform",o)},this.handlePan=i=>{i.preventDefault();const o=it(this.svg.node()),a=o.translate(-i.deltaX/o.k,-i.deltaY/o.k);this.svg.call(this.zoom.transform,a)},this.handleClick=(i,o)=>{let a=this.options.toggleRecursively;(Dt?i.metaKey:i.ctrlKey)&&(a=!a),this.toggleNode(o.data,a)},this.viewHooks=hn(),this.svg=e.datum?e:L(e),this.styleNode=this.svg.append("style"),this.zoom=le().filter(i=>this.options.scrollForPan&&i.type==="wheel"?i.ctrlKey&&!i.button:(!i.ctrlKey||i.type==="wheel")&&!i.button).on("zoom",this.handleZoom),this.setOptions(n),this.state={id:this.options.id||this.svg.attr("id")||$t(),minX:0,maxX:0,minY:0,maxY:0},this.g=this.svg.append("g"),this.revokers.push(dn.tap(()=>{this.setData()}))}getStyleContent(){const{style:e}=this.options,{id:n}=this.state,i=typeof e=="function"?e(n):"";return[this.options.embedGlobalCSS&&_t,i].filter(Boolean).join(`
`)}updateStyle(){this.svg.attr("class",Bt(this.svg.attr("class"),"markmap",this.state.id));const e=this.getStyleContent();this.styleNode.text(e)}toggleNode(e,n=!1){var i,o;const a=(i=e.payload)!=null&&i.fold?0:1;n?J(e,(l,c)=>{l.payload={...l.payload,fold:a},c()}):e.payload={...e.payload,fold:(o=e.payload)!=null&&o.fold?0:1},this.renderData(e)}initializeData(e){let n=0;const{color:i,nodeMinHeight:o,maxWidth:a,initialExpandLevel:l}=this.options,{id:c}=this.state,d=at(q("div",{className:`markmap-container markmap ${c}-g`})),h=at(q("style",{children:[this.getStyleContent(),cn].join(`
`)}));document.body.append(d,h);const p=a?`max-width: ${a}px`:"";let v=0;J(e,(y,X,E)=>{var b,f,C;y.children=(b=y.children)==null?void 0:b.map($=>({...$})),n+=1;const _=at(q("div",{className:"markmap-foreign",style:p,children:q("div",{dangerouslySetInnerHTML:{__html:y.content}})}));d.append(_),y.state={...y.state,id:n,el:_.firstChild},y.state.path=[(f=E==null?void 0:E.state)==null?void 0:f.path,y.state.id].filter(Boolean).join("."),i(y);const B=((C=y.payload)==null?void 0:C.fold)===2;B?v+=1:(v||l>=0&&y.depth>=l)&&(y.payload={...y.payload,fold:1}),X(),B&&(v-=1)});const k=Array.from(d.childNodes).map(y=>y.firstChild);this.viewHooks.transformHtml.call(this,k),k.forEach(y=>{var X;(X=y.parentNode)==null||X.append(y.cloneNode(!0))}),J(e,(y,X,E)=>{var b;const f=y.state,C=f.el.getBoundingClientRect();y.content=f.el.innerHTML,f.size=[Math.ceil(C.width)+1,Math.max(Math.ceil(C.height),o)],f.key=[(b=E==null?void 0:E.state)==null?void 0:b.id,f.id].filter(Boolean).join(".")+y.content,X()}),d.remove(),h.remove()}setOptions(e){this.options={...this.options,...e},this.options.zoom?this.svg.call(this.zoom):this.svg.on(".zoom",null),this.options.pan?this.svg.on("wheel",this.handlePan):this.svg.on("wheel",null)}setData(e,n){n&&this.setOptions(n),e&&(this.state.data=e),this.state.data&&(this.initializeData(this.state.data),this.updateStyle(),this.renderData())}renderData(e){if(!this.state.data)return;const{spacingHorizontal:n,paddingX:i,spacingVertical:o,autoFit:a,color:l}=this.options,c=Tt({}).children(s=>{var x;if(!((x=s.payload)!=null&&x.fold))return s.children}).nodeSize(s=>{const[x,R]=s.data.state.size;return[R,x+(x?i*2:0)+n]}).spacing((s,x)=>s.parent===x.parent?o:o*2),d=c.hierarchy(this.state.data);c(d);const h=d.descendants().reverse(),p=d.links(),v=ee(),k=gt(h,s=>s.x-s.xSize/2),y=yt(h,s=>s.x+s.xSize/2),X=gt(h,s=>s.y),E=yt(h,s=>s.y+s.ySize-n);Object.assign(this.state,{minX:k,maxX:y,minY:X,maxY:E}),a&&this.fit();const b=e&&h.find(s=>s.data===e)||d,f=b.data.state.x0??b.x,C=b.data.state.y0??b.y,_=this.g.selectAll(K("g")).data(h,s=>s.data.state.key),B=_.enter().append("g").attr("data-depth",s=>s.data.depth).attr("data-path",s=>s.data.state.path).attr("transform",s=>`translate(${C+b.ySize-s.ySize},${f+b.xSize/2-s.xSize})`),$=this.transition(_.exit());$.select("line").attr("x1",s=>s.ySize-n).attr("x2",s=>s.ySize-n),$.select("foreignObject").style("opacity",0),$.attr("transform",s=>`translate(${b.y+b.ySize-s.ySize},${b.x+b.xSize/2-s.xSize})`).remove();const D=_.merge(B).attr("class",s=>{var x;return["markmap-node",((x=s.data.payload)==null?void 0:x.fold)&&"markmap-fold"].filter(Boolean).join(" ")});this.transition(D).attr("transform",s=>`translate(${s.y},${s.x-s.xSize/2})`);const H=D.selectAll(K("line")).data(s=>[s],s=>s.data.state.key).join(s=>s.append("line").attr("x1",x=>x.ySize-n).attr("x2",x=>x.ySize-n),s=>s,s=>s.remove());this.transition(H).attr("x1",-1).attr("x2",s=>s.ySize-n+2).attr("y1",s=>s.xSize).attr("y2",s=>s.xSize).attr("stroke",s=>l(s.data)).attr("stroke-width",bt);const V=D.selectAll(K("circle")).data(s=>{var x;return(x=s.data.children)!=null&&x.length?[s]:[]},s=>s.data.state.key).join(s=>s.append("circle").attr("stroke-width","1.5").attr("cx",x=>x.ySize-n).attr("cy",x=>x.xSize).attr("r",0).on("click",(x,R)=>this.handleClick(x,R)).on("mousedown",st),s=>s,s=>s.remove());this.transition(V).attr("r",6).attr("cx",s=>s.ySize-n).attr("cy",s=>s.xSize).attr("stroke",s=>l(s.data)).attr("fill",s=>{var x;return(x=s.data.payload)!=null&&x.fold&&s.data.children?l(s.data):"#fff"});const F=D.selectAll(K("foreignObject")).data(s=>[s],s=>s.data.state.key).join(s=>{const x=s.append("foreignObject").attr("class","markmap-foreign").attr("x",i).attr("y",0).style("opacity",0).on("mousedown",st).on("dblclick",st);return x.append("xhtml:div").select(function(R){const r=R.data.state.el.cloneNode(!0);return this.replaceWith(r),r}).attr("xmlns","http://www.w3.org/1999/xhtml"),x},s=>s,s=>s.remove()).attr("width",s=>Math.max(0,s.ySize-n-i*2)).attr("height",s=>s.xSize);this.transition(F).style("opacity",1);const G=this.g.selectAll(K("path")).data(p,s=>s.target.data.state.key).join(s=>{const x=[C+b.ySize-n,f+b.xSize/2];return s.insert("path","g").attr("class","markmap-link").attr("data-depth",R=>R.target.data.depth).attr("data-path",R=>R.target.data.state.path).attr("d",v({source:x,target:x}))},s=>s,s=>{const x=[b.y+b.ySize-n,b.x+b.xSize/2];return this.transition(s).attr("d",v({source:x,target:x})).remove()});this.transition(G).attr("stroke",s=>l(s.target.data)).attr("stroke-width",s=>bt(s.target)).attr("d",s=>{const x=s.source,R=s.target,r=[x.y+x.ySize-n,x.x+x.xSize/2],m=[R.y,R.x+R.xSize/2];return v({source:r,target:m})}),h.forEach(s=>{s.data.state.x0=s.x,s.data.state.y0=s.y})}transition(e){const{duration:n}=this.options;return e.transition().duration(n)}async fit(){const e=this.svg.node(),{width:n,height:i}=e.getBoundingClientRect(),{fitRatio:o}=this.options,{minX:a,maxX:l,minY:c,maxY:d}=this.state,h=d-c,p=l-a,v=Math.min(n/h*o,i/p*o,2),k=dt.translate((n-h*v)/2-c*v,(i-p*v)/2-a*v).scale(v);return this.transition(this.svg).call(this.zoom.transform,k).end().catch(tt)}async ensureView(e,n){let i;if(this.g.selectAll(K("g")).each(function(f){f.data===e&&(i=f)}),!i)return;const o=this.svg.node(),{spacingHorizontal:a}=this.options,l=o.getBoundingClientRect(),c=it(o),[d,h]=[i.y,i.y+i.ySize-a+2].map(f=>f*c.k+c.x),[p,v]=[i.x-i.xSize/2,i.x+i.xSize/2].map(f=>f*c.k+c.y),k={left:0,right:0,top:0,bottom:0,...n},y=[k.left-d,l.width-k.right-h],X=[k.top-p,l.height-k.bottom-v],E=y[0]*y[1]>0?kt(y,Math.abs)/c.k:0,b=X[0]*X[1]>0?kt(X,Math.abs)/c.k:0;if(E||b){const f=c.translate(E,b);return this.transition(this.svg).call(this.zoom.transform,f).end().catch(tt)}}async rescale(e){const n=this.svg.node(),{width:i,height:o}=n.getBoundingClientRect(),a=i/2,l=o/2,c=it(n),d=c.translate((a-c.x)*(1-e)/c.k,(l-c.y)*(1-e)/c.k).scale(e);return this.transition(this.svg).call(this.zoom.transform,d).end().catch(tt)}destroy(){this.svg.on(".zoom",null),this.svg.html(null),this.revokers.forEach(e=>{e()})}static create(e,n,i=null){const o=new ht(e,n);return i&&(o.setData(i),o.fit()),o}};Rt.defaultOptions={autoFit:!1,color:t=>{var e;return fn(`${((e=t.state)==null?void 0:e.path)||""}`)},duration:500,embedGlobalCSS:!0,fitRatio:.95,maxWidth:0,nodeMinHeight:16,paddingX:8,scrollForPan:Dt,spacingHorizontal:80,spacingVertical:5,initialExpandLevel:-1,zoom:!0,pan:!0,toggleRecursively:!1};let pn=Rt;function En(t){const e={},n={...t},{color:i,colorFreezeLevel:o}=n;if((i==null?void 0:i.length)===1){const a=i[0];e.color=()=>a}else if(i!=null&&i.length){const a=wt(i);e.color=l=>a(`${l.state.path}`)}if(o){const a=e.color||pn.defaultOptions.color;e.color=l=>(l={...l,state:{...l.state,path:l.state.path.split(".").slice(0,o).join(".")}},a(l))}return["duration","maxWidth","initialExpandLevel"].forEach(a=>{const l=n[a];typeof l=="number"&&(e[a]=l)}),["zoom","pan"].forEach(a=>{const l=n[a];l!=null&&(e[a]=!!l)}),e}export{pn as Markmap,fn as defaultColorFn,En as deriveOptions,wn as globalCSS,Tn as loadCSS,Cn as loadJS,dn as refreshHook};
